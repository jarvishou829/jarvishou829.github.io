<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="description" content="TaMMa: Target-driven Multi-subscene Mobile Manipulation">
    <meta name="keywords" content="Robotics, Target-driven Manipulation, Gaussian Splatting, Depth Completion, Scene Inpainting">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TaMMa: Target-driven Multi-subscene Mobile Manipulation</title>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <style>
		.render_wrapper {
			position: relative;
            height: 300px;
         }
        .render_wrapper_small {
			position: relative;
            height: 200px;
         }
		.render_div {
			position: absolute;
			top: 0;
			left: 0;
		}

        #interpolation-image-wrapper-car{
            text-align: center;
        }
        #interpolation-image-wrapper-chair{
            text-align: center;
        }
        .nested-columns {
            margin-bottom: 0 !important;
        }
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
</head>

<body>

    <section class="hero">
        <div class="hero-body">
            <div class="container is-max-widescreen">
                <div class="columns is-centered">
                    <div class="column has-text-centered">
                        <div class="column is-full_width">
                            <h1 class="title is-1 publication-title"><p>TaMMa: Target-driven Multi-subscene Mobile Manipulation</p></h1>
                        </div>

                        <!-- <div class="column is-full_width">
                          <h2 class="title is-4">International Conference on Computer Vision (ICCV), 2023</h2>
                        </div> -->

                        <div class="is-size-3 publication-authors">
                            <span class="author-block">
                                <a href="http://jarvishou829.github.io/">Jiawei Hou</a>,</span>
                            <span class="author-block">
                                <a href="">Tianyu Wang</a>,</span>
                            <span class="author-block">
                                <a href="">Tongying Pan</a>,</span>
                            <span class="author-block">
                                <a href="">Shouyan Wang</a>,</span>
                            <span class="author-block">
                                <a href="">Xiangyang Xue</a>,</span>
                            <span class="author-block">
                                <a href="">Yanwei Fu</a></span>
                        </div>

                        <div class="is-size-3 publication-authors">
                            <span class="author-block">Fudan University</span>
                        </div>
                        
                        <div class="column has-text-centered">
                            <div class="publication-links">

                                <!-- PDF Link. -->
                                <span class="link-block">
                                    <a href="./resources/images/preprint.pdf"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fas fa-file-pdf"></i>
                                        </span>
                                        <span>Paper</span>
                                    </a>
                                </span>
                                <span class="link-block">
                                    <a class="external-link button is-normal is-rounded is-dark" href="">
                                        <span class="icon">
                                            <i class="ai ai-arxiv"></i>
                                        </span>
                                        <span>arXiv</span>
                                    </a>
                                </span>
                                <span class="link-block">
                                    <a href="./resources/images/preprint.pdf"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fas fa-file-pdf"></i>
                                        </span>
                                        <span>Supp</span>
                                    </a>
                                </span>

                                <!-- Github Link. -->
                                <span class="link-block">
                                    <a href="" class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fab fa-github"></i>
                                        </span>
                                        <span>Code(Soon)</span>
                                    </a>
                                </span>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="hero teaser">
        <div class="container is-max-desktop">
            <div class="hero-body">
                <div align="center"><img src="./resources/images/idea.png" width="100%" /></div>
                <h2 class=" subtitle has-text-centered" style="padding-top: 10px">
                    Our proposed multi-subscene mobile manipulation approach. Coarse scene prior and refined pose estimation empower the mobile base movement and robotic arm manipulation effectively and efficiently on compositional challenging tasks such as pouring, stacking, and tidy-up.
                </h2>
            </div>
        </div>
    </section>

    <section class="hero teaser">
        <div class="container is-max-desktop">
            <div class="hero-body">
                <div align="center"><video src="./resources/images/196_TaMMa_Target_driven_Multi__Spotlight Video.mp4" controls width="100%"></video></div>
            </div>
        </div>
    </section>


    <section class="section">
        <div class="container is-max-desktop">
            <!-- Abstract. -->
            <div class="columns is-centered has-text-centered">
                <div class="column is-four-fifths">
                    <h2 class="title is-3">Abstract</h2>
                    <div class="content has-text-justified">
                        <p>
                            For everyday service robotics, the ability to navigate back and forth based on tasks in multi-subscene environments and perform delicate manipulations is crucial and highly practical. While existing robotics primarily focus on complex tasks within a single scene or simple tasks across scalable scenes individually, robots consisting of a mobile base with a robotic arm face the challenge of efficiently representing multiple subscenes, coordinating the collaboration between the mobile base and the robotic arm, and managing delicate tasks in scalable environments.
                        </p>
                            
                        <p>
                            To address this issue, we propose Target-driven Multi-subscene Mobile Manipulation (\textit{TaMMa}), which efficiently handles mobile base movement and fine-grained manipulation across subscenes. Specifically, we obtain a reliable 3D Gaussian initialization of the whole scene using a sparse 3D point cloud with encoded semantics. Through querying the coarse Gaussians, we acquire the approximate pose of the target, navigate the mobile base to approach it, and reduce the scope of precise target pose estimation to the corresponding subscene. Optimizing while moving, we employ diffusion-based depth completion to optimize fine-grained Gaussians and estimate the target's refined pose. For target-driven manipulation, we adopt Gaussians inpainting to obtain precise poses for the origin and destination of the operation in a \textit{think before you do it} manner, enabling fine-grained manipulation. 
                        </p>
                                
                        <p>
                            We conduct various experiments on a real robotic to demonstrate our method in effectively and efficiently achieving precise operation tasks across multiple tabletop subscenes.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- Paper video. -->
        <!-- <div align="center">
            <img src="./resources/images/pourit_logo_robot.jpg" width="30%" />
        </div>
        <div class="columns is-centered has-text-centered">
            <div class="column is-three-fifths">
                <div class="publication-video">
                    <iframe style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;" src="https://player.bilibili.com/player.html?aid=616136613&bvid=BV1Th4y1L77j&cid=1204194164&page=1&high_quality=1&danmaku=0" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>
                </div>
                <br>

                </br>
                <div class="publication-video">
                   <iframe width="1254" height="705" src="https://www.youtube.com/embed/R5SpiV0658Q" title="PourIt!: Robotic Maestros&#39;s Elegance in Liquid Symphony (ICCV2023)" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                </div>
            </div>

        </div> -->
        <!--/ Paper video. -->
    </section>


    <section class="section">
        <div class="container is-max-desktop">

            <!-- Overview. -->
            <div class="columns is-centered" style="margin-top: 15px">
                <div class="column is-full-width">
                    <h2 class="title is-3">Method Overview</h2>
                    <img src="./resources/images/method.png"/>
                    <div class="content has-text-justified" style="padding-top: 15px">
                        <p>
                            RGB-D sequences with camera poses are used for point cloud unprojection, which initializes the Gaussians. Grounded-Light-HQ-SAM is employed to encode semantics for Gaussians and depth completion. The coarse Gaussians provide a scene prior to mobile base navigation; further, a fine-grained manipulation target pose is optimized from completed and inpainted Gaussians with an object mask.
                        </p>
                    </div>

                </div>
            </div>

        </div>
    </section>

    <!-- <section class="section">
        <div class="container">
            <div class="columns is-centered" style="margin-top: 15px">
                <div class="column is-full-width">
                    <h2 class="title is-3">Interactive Demonstration (Coming Soon)</h2>
                    <div class="content has-text-justified" style="padding-top: 15px">
                        <p>
                            In this interactive demo, we show a heatmap of association between 3D points and the text and image
                            queries powered by LOP association from trained LOP-Field. 
                        </p>
                    </div>
                    <iframe src="pcd.html" title="Matterport3D interactive demo" width="100%" height="720px"></iframe>
                </div>
            </div>
        </div>
    </section> -->

    <section class="section">
        <div class="container is-max-desktop">

            <!-- Overview. -->
            <div class="columns is-centered" style="margin-top: 15px">
                <div class="column is-full-width">
                    <h2 class="title is-3">Challenging tasks supported</h2>
                    <div align="center">
                        <img src="./resources/images/tasks.png" width="100%"/>
                    </div>


                </div>
            </div>

        </div>
    </section>



<section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>
        @inproceedings{hou2024tamma,
            title={TaMMa: Target-driven Multi-subscene Mobile Manipulation},
            author={Hou, Jiawei and Wang, Tianyu and Wang, Shouyan and Xue, Xiangyang and Fu, Yanwei},
            booktitle = {arXiv},
            year = {2024},
        }
    </code></pre>
    </div>
</section>

    <!-- <section class="section">
        <div class="container is-max-desktop content">
            <h2 class="title">Acknowledgements</h2>
            We thank <a href="https://storage.googleapis.com/www.connorschenck.com/index.html">Dr. Connor Schenck</a>
            for providing the <a href="https://rse-lab.cs.washington.edu/lpd/">UW Liquid Pouring Dataset</a>.
        </div>
    </section> -->


    <footer class="footer">
        <div class="container">
            <div class="content has-text-centered">
                <a class="icon-link" href="./resources/images/preprint.pdf">
                    <i class="fas fa-file-pdf"></i>
                </a>
                <a class="icon-link" href="https://github.com/jarvishou829/LOP-Field" class="external-link" disabled>
                    <i class="fab fa-github"></i>
                </a>
            </div>
            <div class="columns is-centered">
                <div class="column is-8">
                    <div class="content">
                        <!-- <p style="text-align:center">
                            Source code mainly borrowed from <a href="https://niessnerlab.org/members/yawar_siddiqui/profile.html">Yawar Siddiqui</a>'s <a
                                href="https://nihalsid.github.io/texturify/">Texturify website</a>.
                        </p> -->
                        <p style="text-align:center">
                            Please contact <a href="jwhou23@m.fudan.edu.cn">Jiawei Hou</a> for feedback and questions.
                        </p>

                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Import maps polyfill -->
    <!-- Remove this when import maps will be widely supported -->
    <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>

    <script type="importmap">
        {
            "imports": {
                "three": "./js/three.module.js"
            }
        }
    </script>

    <script type="module">

        import * as THREE from 'three';

        import { PLYLoader } from './js/PLYLoader.js';
        import { OBJLoader } from './js/OBJLoader.js';
        import { MTLLoader } from './js/MTLLoader.js';
        import { OrbitControls } from './js/OrbitControls.js'
        let div_to_scene = {
            "compass": {},
            "ambulance": {},
            "backpack": {},
            "dumpster": {},
            "baroque": {},
            "wooden": {},
            "cyberpunk": {},
            "lego": {},
            "airplane": {},
            "crocodile": {},
            "hippo": {},
            "sheep": {}
        };
        let div_camera = {
            "compass": null,
            "ambulance": null,
            "backpack": null,
            "dumpster": null,
            "baroque": null,
            "wooden": null,
            "cyberpunk": null,
            "lego": null,
            "airplane": null,
            "crocodile": null,
            "hippo": null,
            "sheep": null,
        };

        let mouse_button_down = false;
        let list_of_orbit_controls = []
        let style_camera = null;
        let render_colors = true;
        let style_id = "0"

        function setup_camera(div_name){
            let container = document.getElementById(div_name);
            let width = container.parentElement.clientWidth;
            let height = container.parentElement.clientHeight;
            console.log(width, height)
            let camera = new THREE.PerspectiveCamera( 35, width / height, 0.1, 50 );
            let camera_init_position = new THREE.Vector3( -1, 0.5, 1 );
            if (div_name.includes("compass")){
                camera_init_position = new THREE.Vector3( 1, 1.5, 1 );
            }
            else if (div_name.includes("ambulance")) {
                camera_init_position = new THREE.Vector3( -1.1, 0.5, 1.1 );
            }
            // else if (div_name.includes("backpack")) {
            //     camera_init_position = new THREE.Vector3( -1.5, 0.5, 1.5 );
            // }
            camera.position.set(camera_init_position.x, camera_init_position.y, camera_init_position.z);
            return camera;
        }

        function setup_render_divs(div_name, obj_name, obj_path, mtl_path, texture_path){
            if (div_camera[obj_name] == null) {
                div_camera[obj_name] = setup_camera(div_name)
            }

            let orbit_control = create_render_div(div_camera[obj_name], div_name, obj_name, obj_path, mtl_path, texture_path)
            list_of_orbit_controls.push(orbit_control)
        }

        function create_render_div(camera, div_id, obj_name, obj_path, mtl_path, texture_path) {
            let container;
            let renderer, controls;

            init();
            animate();

            function init() {

                container = document.getElementById(div_id);
                let width = container.parentElement.clientWidth;
                let height = container.parentElement.clientHeight;


                div_to_scene[obj_name][div_id] = new THREE.Scene();
                div_to_scene[obj_name][div_id].background = new THREE.Color( 0xffffff );

                // ObJ file

                const objLoader  = new OBJLoader();
                const textureLoader = new THREE.TextureLoader();
                const mtlLoader = new MTLLoader();

                mtlLoader.load(mtl_path, function ( materials ) {
                    materials.preload();
                    objLoader
                        .setMaterials( materials )
                        .load( obj_path, function ( object ) {
                            textureLoader
                                .load( texture_path, function ( texture ) {
                                    object.traverse (function ( child ) {
                                        if ( child instanceof THREE.Mesh ) {
                                            child.material.map = texture;
                                        }
                                    });

                                    div_to_scene[obj_name][div_id].add( object );
                                });
                        });
                });

                div_to_scene[obj_name][div_id].add( new THREE.HemisphereLight( 0x333333, 0x222222 ) );
                addShadowedLight(div_to_scene[obj_name][div_id], 1, 1, 1, 0xffffff, 1 );
                addShadowedLight(div_to_scene[obj_name][div_id],  -1, -1, - 1, 0xffffff, 0.5 );

                // renderer

                renderer = new THREE.WebGLRenderer( { antialias: true } );
                renderer.setPixelRatio( window.devicePixelRatio );
                renderer.setSize( width, height);
                renderer.outputEncoding = THREE.sRGBEncoding;

                renderer.shadowMap.enabled = true;

                container.appendChild( renderer.domElement );

                controls = new OrbitControls(camera, renderer.domElement)
                controls.enableDamping = false

                // resize

                window.addEventListener( 'resize', onWindowResize );

        }
            function onWindowResize() {
                let width = container.clientWidth;
                let height = container.clientHeight;
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
                renderer.setSize( width, height );
            }
            function animate() {
                requestAnimationFrame( animate );
                render();
            }

            function render() {
                renderer.render( div_to_scene[obj_name][div_id], camera );
                controls.update();
            }

            return controls;
        }

        function addShadowedLight(scene, x, y, z, color, intensity ) {

            const directionalLight = new THREE.DirectionalLight( color, intensity );
            directionalLight.position.set( x, y, z );
            scene.add( directionalLight );

            directionalLight.castShadow = true;

            const d = 1;
            directionalLight.shadow.camera.left = - d;
            directionalLight.shadow.camera.right = d;
            directionalLight.shadow.camera.top = d;
            directionalLight.shadow.camera.bottom = - d;

            directionalLight.shadow.camera.near = 1;
            directionalLight.shadow.camera.far = 4;

            directionalLight.shadow.mapSize.width = 1024;
            directionalLight.shadow.mapSize.height = 1024;

            directionalLight.shadow.bias = - 0.001;

        }

        document.addEventListener('keydown', logKey);

        function logKey(evt) {
            if (evt.keyCode === 82 && !mouse_button_down) {
                reset_orbit_controls()
            }
        }

        function reset_orbit_controls() {
            list_of_orbit_controls.forEach(oc => {
                oc.reset()
            })
        }

        document.body.onmousedown = function(evt) {
            if (evt.button === 0)
                mouse_button_down = true
        }
        document.body.onmouseup = function(evt) {
            if (evt.button === 0)
                mouse_button_down = false
        }

        window.onload = function() {
            let slider = document.getElementsByClassName("slider")[0]
            slider.removeAttribute("tabIndex")
            // slider.addEventListener("mouseout", reset_orbit_controls);

            // const qualitative = ["compass", "ambulance", "backpack", "dumpster"];
            const qualitative = ["compass", "ambulance"];

            qualitative.forEach(element => {
                setup_render_divs(element+"_geo", element,
                './samples/qualitative/'+element+'/geo/mesh_normalized.obj',
                './samples/qualitative/'+element+'/geo/mesh_normalized.mtl',
                './samples/qualitative/'+element+'/geo/mesh_normalized.png'
                );
                setup_render_divs(element+"_clipmesh", element,
                    './samples/qualitative/'+element+'/clipmesh/mesh_normalized.obj',
                    './samples/qualitative/'+element+'/clipmesh/mesh_normalized.mtl',
                    './samples/qualitative/'+element+'/clipmesh/mesh_normalized.png'
                );
                setup_render_divs(element+"_latentpaint", element,
                    './samples/qualitative/'+element+'/latentpaint/mesh_normalized.obj',
                    './samples/qualitative/'+element+'/latentpaint/mesh_normalized.mtl',
                    './samples/qualitative/'+element+'/latentpaint/mesh_normalized.png'
                );
                setup_render_divs(element+"_ours", element,
                    './samples/qualitative/'+element+'/ours/mesh_normalized.obj',
                    './samples/qualitative/'+element+'/ours/mesh_normalized.mtl',
                    './samples/qualitative/'+element+'/ours/mesh_normalized.png'
                );
            });


            const styles = ["baroque", "wooden", "cyberpunk", "lego"];
            styles.forEach(element => {
                setup_render_divs(element+"_porsche", element,
                './samples/different_style/'+element+'_porsche/mesh_normalized.obj',
                './samples/different_style/'+element+'_porsche/mesh_normalized.mtl',
                './samples/different_style/'+element+'_porsche/mesh_normalized.png'
                );
            });

            const others = ["airplane", "crocodile", "hippo", "sheep"];
            others.forEach(element => {
                setup_render_divs(element+"_porsche", element,
                './samples/wrong_prompt/'+element+'/mesh_normalized.obj',
                './samples/wrong_prompt/'+element+'/mesh_normalized.mtl',
                './samples/wrong_prompt/'+element+'/mesh_normalized.png'
                );
            });

        };

    </script>
</body>

</html>